"0",""
"0","# Ensure Treatment is a factor"
"0","group_bio2$Treatment <- as.factor(group_bio2$Treatment)"
"0","group_bio2$Day <- factor(group_bio2$Day, levels = c(-4, 3, 10, 15, 24, 30, 38))  # Specify custom order"
"0",""
"0","# Step 1: Create an ordered factor version of Day just for plotting"
"0","group_bio2 <- group_bio2 %>%"
"0","  mutate(Day_flag = ifelse(Day %in% c(3, 15, 30), ""highlight"", ""normal""))  # Create ordered factor for plotting"
"0",""
"0",""
"0",""
"0","# Step 2: Build the plot"
"0","p_phyto <- ggplot(group_bio2, aes(x = Treatment, y = relative_bio, fill = group)) +"
"0","  geom_bar(stat = ""identity"", position = ""stack"") +"
"0","  labs(x = """", y = ""Relative Biomass (%)"") +"
"0","  scale_fill_brewer(palette = ""Set1"") +  # Apply a ColorBrewer palette"
"0","  theme_bw(base_size = 20) +"
"0","  theme("
"0","    panel.background = element_rect(fill = ""white"", colour = ""black""),"
"0","    plot.title = element_text(hjust = 0.5, margin = margin(b = 20), size = 20, face = ""bold""),"
"0","    axis.text = element_text(size = 30),"
"0","    axis.title = element_text(size = 30),"
"0","    legend.text = element_text(size = 30),"
"0","    legend.title = element_text(size = 30),"
"0","    legend.key.size = unit(1.5, ""lines""),"
"0","    legend.position = ""bottom"","
"0","    legend.justification = ""center"","
"0","    legend.direction = ""horizontal"","
"0","    legend.box = ""vertical"","
"0","    axis.text.x = element_text(hjust = 1),"
"0","    strip.text = element_text(size = 30)"
"0","  ) +"
"0","  "
"0","  # Use facet_wrap2 from ggh4x to apply custom strip colors and order by Day_plot (ordered factor)"
"0","  facet_wrap2("
"0","    ~ Day,   # Use Day_plot to control the order"
"0","    scales = ""free_x"","
"0","    strip = strip_themed("
"0","      background_x = elem_list_rect("
"0","        # Apply different colors conditionally"
"0","        fill = ifelse(unique(group_bio2$Day) %in% c(3, 15, 30), ""lightcoral"", ""white""),"
"0","        color = ""black""  # Set a border color for all strips"
"0","      )"
"0","    ),"
"0","    labeller = label_value,  # Ensure Day labels are correctly displayed"
"0","    nrow = 3                 "
"0","  )"
"0","# Display the plot"
"0","print(p_phyto)"
