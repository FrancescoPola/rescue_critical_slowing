"0","try <- group_bio2[, -c(6,7)] %>% group_by(Sample, Treatment, Day) %>% summarize(total = sum(total_biomass)) %>% ungroup() "
"1","[38;5;250m`summarise()` has grouped output by 'Sample', 'Treatment'. You can override using the `.groups` argument.[39m
"
"0","try <- try %>% mutate(bio_log = log10(total))"
"0","# Calculate mean abundance and standard error for Control"
"0","control_mean <- try %>% filter(Treatment == ""Control"") %>%"
"0","  group_by(Day) %>%"
"0","  summarize(control_mean_bio = mean(bio_log, na.rm = TRUE))"
"0",""
"0","# Calculate differences from Control for each treatment"
"0","tot.bio_diff <- try %>%"
"0","  left_join(control_mean, by = ""Day"") %>%"
"0","  mutate(diff_bio = control_mean_bio - bio_log)"
"0",""
"0",""
"0",""
"0","resilience_HW1 <- tot.bio_diff %>% filter(Day %in% c(-4, 10),"
"0","                                    Treatment == ""HW"") %>% "
"0","  group_by(Sample) %>% "
"0","  mutate(resilience = abs(diff_bio[Day == -4] / diff_bio[Day == 10])) %>% "
"0","  filter(Day == -4)"
"0",""
"0",""
"0","resilience_HW2 <- tot.bio_diff %>% filter(Day %in% c(10, 24),"
"0","                                     Treatment == ""HW"") %>% "
"0","  group_by(Sample) %>% "
"0","  mutate(resilience = abs(diff_bio[Day == 10] / diff_bio[Day == 24])) %>% "
"0","  filter(Day == 24)"
"0",""
"0",""
"0",""
"0","resilience_HW3 <- tot.bio_diff %>% filter(Day %in% c(24, 38),"
"0","                                     Treatment == ""HW"") %>% "
"0","  group_by(Sample) %>% "
"0","  mutate(resilience = abs(diff_bio[Day == 24] / diff_bio[Day == 38])) %>% "
"0","  filter(Day == 38)"
"0",""
"0",""
"0","resilience <- rbind(resilience_HW1, resilience_HW2, resilience_HW3)"
"0",""
"0",""
"0","resilience <- resilience %>%"
"0","  mutate(heat = case_when("
"0","    Day == -4 ~ 1,"
"0","    Day == 24 ~ 2,"
"0","    Day == 38 ~ 3"
"0","  ))"
"0",""
"0","min_y <- min(log10(resilience$resilience))"
"0","max_y <- max(log10(resilience$resilience))"
"0",""
"0","p_resilience_phyto <- ggplot(resilience, aes(x = heat, y = log10(resilience), group = Day)) +"
"0","  geom_boxplot() +"
"0","  geom_point(aes(color = as.factor(Sample)), position = position_jitterdodge(), size = 3) +"
"0","  labs(x = ""Heatwave"", y = ""Resilience"", tag = ""(b)"") +"
"0","  theme_minimal(base_size = 20) +"
"0","  theme("
"0","    panel.background = element_rect(fill = ""white"", colour = ""black""),  # Set panel background"
"0","    plot.title = element_text(hjust = 0.5, margin = margin(b = 20), size = 20, face = ""bold""),  # Set plot title text size and make it bold"
"0","    axis.text = element_text(size = 30),  # Set axis text size"
"0","    axis.title = element_text(size = 30),  # Set axis title text size"
"0","    plot.tag = element_text(size = 30),"
"0","    legend.position = ""none""   # Set tag size"
"0","  ) +"
"0","  scale_fill_brewer(palette = ""Set1"") +"
"0","  scale_y_continuous(breaks = seq(floor(min_y), ceiling(max_y), by = 1)) +"
"0","  geom_hline(yintercept = 1, linetype = ""dashed"")  # Add a horizontal line at y = 1"
"0",""
