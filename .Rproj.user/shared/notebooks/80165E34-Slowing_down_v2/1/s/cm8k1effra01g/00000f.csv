"0",""
"0","# Calculate mean ox for Control by day"
"0","control_bm <- ox %>% "
"0","  filter(Treatment == ""Control"") %>%"
"0","  group_by(Day) %>% "
"0","  dplyr::summarize(mean_ox_control = mean(ox, na.rm = TRUE))"
"0",""
"0","# Calculate mean ox for all treatments by day and cosm"
"0","ox_all_treat <- ox %>% "
"0","  group_by(Day, Cosm, Treatment) %>% "
"0","  dplyr::summarize(mean_ox = mean(ox, na.rm = TRUE))"
"1","[38;5;250m`summarise()` has grouped output by 'Day', 'Cosm'. You can override using the `.groups`
argument.[39m
"
"0","# Merge the control and treatment data"
"0","ox_merged <- merge(ox_all_treat, control_bm, by = ""Day"")"
"0",""
"0","# Remove Day -4"
"0","ox_merged <- ox_merged %>% "
"0","  filter(Day != -4)"
"0",""
"0","# Calculate the difference between HW and control"
"0","ox_merged <- ox_merged %>% "
"0","  mutate(diff = mean_ox - mean_ox_control)"
"0",""
"0","# Filter HW data"
"0","hw_data <- ox_merged %>% filter(Treatment == ""HW"")"
"0",""
"0","# Add a range column to hw_data with the correct order"
"0","hw_data <- hw_data %>% "
"0","  mutate(range = case_when("
"0","    Day >= 3 & Day <= 10 ~ ""3 - 10"","
"0","    Day >= 15 & Day <= 24 ~ ""15 - 24"","
"0","    Day >= 30 & Day <= 38 ~ ""30 - 38"","
"0","    TRUE ~ NA_character_"
"0","  )) %>%"
"0","  filter(!is.na(range))"
"0",""
"0","# Set the order of the range levels"
"0","hw_data$range <- factor(hw_data$range, levels = c(""3 - 10"", ""15 - 24"", ""30 - 38""))"
"0",""
"0","# Function to fit linear model"
"0","fit_lm <- function(data) {"
"0","  lm_model <- lm(diff ~ Day, data = data)"
"0","  return(lm_model)"
"0","}"
"0",""
"0","# Apply function to each day range and store models"
"0","lm_models <- hw_data %>%"
"0","  group_by(range) %>%"
"0","  do(model = fit_lm(.))"
"0",""
"0","# Extract slopes"
"0","slopes <- lm_models %>%"
"0","  rowwise() %>%"
"0","  mutate(slope = coef(model)[""Day""]) %>%"
"0","  select(range, slope) %>%"
"0","  ungroup()"
"0",""
"0","# Create a combined plot"
"0","combined_plot <- ggplot(hw_data, aes(x = Day, y = diff)) +"
"0","  geom_point(aes(color = as.factor(Cosm)), size = 3) +"
"0","  geom_smooth(method = ""lm"", se = FALSE) +"
"0","  labs(x = ""Day"", y = ""Difference (HW - Control)"") +"
"0","  theme_bw(base_size = 22) +"
"0","  theme(legend.position = ""none"") +"
"0","  facet_wrap(~ range, scales = ""free"", ncol = 3) +"
"0","  scale_x_continuous(breaks = scales::pretty_breaks(n = 5)) +  # Ensures integer breaks on x-axis"
"0","  labs(tag = ""(b)"")"
"0",""
"0","# Add slope annotations"
"0","combined_plot <- combined_plot +"
"0","  geom_text(data = slopes, aes(x = Inf, y = Inf, label = paste0(""Slope: "", round(slope, 3))), "
"0","            hjust = 1.5, vjust = 1.2, size = 4)"
"0",""
"0","print(combined_plot)"
"1","[38;5;250m`geom_smooth()` using formula = 'y ~ x'[39m
"
