"0",""
"0",""
"0","# Day 15 SIMPER results"
"0","day_38_simper <- simper_results[[7]]$SIMPER_result"
"0",""
"0","# Extract SIMPER results for a specific comparison (e.g., ""HW_Control"")"
"0","simper_table <- day_38_simper$HW_Control"
"0",""
"0","# Convert to a data frame for better formatting"
"0","simper_df <- as.data.frame(simper_table)"
"0",""
"0","# Round the numeric columns to a maximum of three decimals"
"0","simper_df[] <- lapply(simper_df, function(x) if (is.numeric(x)) round(x, 3) else x)"
"0",""
"0","# Add a column for species names"
"0","simper_df <- cbind(species = rownames(simper_df), simper_df)"
"0",""
"0","# Print SIMPER results in HTML format using kableExtra (for previewing, optional)"
"0","simper_table_html <- simper_df %>%"
"0","  kable(format = ""html"", digits = 3, caption = ""SIMPER Analysis Results for Day 38: HW vs Control"") %>%"
"0","  kable_styling(full_width = FALSE, bootstrap_options = c(""striped"", ""hover""))"
"0",""
"0","# Prepare species abundance comparison (example data)"
"0","species_abundance_comparison <- data.frame("
"0","  species = rownames(simper_df),"
"0","  HW_abundance = runif(nrow(simper_df), min = 1, max = 100),  # Replace with actual data"
"0","  Control_abundance = runif(nrow(simper_df), min = 1, max = 100)  # Replace with actual data"
"0",")"
"0",""
"0","# Round numeric columns in species Biomass comparison"
"0","species_abundance_comparison[] <- lapply(species_abundance_comparison, function(x) if (is.numeric(x)) round(x, 3) else x)"
"0",""
"0","# Print species abundance comparison in HTML format using kableExtra (for previewing, optional)"
"0","species_abundance_html <- species_abundance_comparison %>%"
"0","  kable(format = ""html"", digits = 3, caption = ""Species Biomass Comparison for Day 38: HW vs Control"") %>%"
"0","  kable_styling(full_width = FALSE, bootstrap_options = c(""striped"", ""hover""))"
"0",""
"0",""
"0","# Convert SIMPER results to flextable"
"0","ft_simper <- flextable(simper_df)"
"0",""
"0",""
"0","# Convert species Biomass comparison to flextable"
"0","ft_species_abundance <- flextable(species_abundance_comparison)"
"0",""
"0",""
"0","# Create a new Word document"
"0","doc <- read_docx() %>%"
"0","  body_add_par(""SIMPER Analysis Results for Day 38: HW vs Control"", style = ""heading 1"") %>%"
"0","  body_add_flextable(ft_simper) %>%"
"0","  body_add_par("""") %>%"
"0","  body_add_par(""Species Biomass Comparison for Day 38: HW vs Control"", style = ""heading 1"") %>%"
"0","  body_add_flextable(ft_species_abundance)"
"0",""
"0","# Save the document"
"0","print(doc, target = ""Tables/SIMPER_Results_Day_38_with_comparison.docx"")"
"0",""
"0",""
"0",""
"0",""
